<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Il cielo del mese - Astri Nascenti</title>

<style>
@font-face {
  font-family: 'LemonMilkLight';
  src: url('fonts/LemonMilk-Light.woff2') format('woff2'),
       url('fonts/LemonMilk-Light.woff') format('woff');
  font-display: swap;
}

/* VARIABILI */
:root{
  --bg-gradient: linear-gradient(rgba(0,0,0,.85), rgba(0,0,0,.95));
  --content-bg: rgba(0,0,0,0.55);
  --accent: #c9d6df;
  --highlight: #e53935;
  --base-font-size: 18px;
  --text-color: #ffffff;
}

/* RESET + BASE */
* { box-sizing: border-box; margin:0; padding:0; }
html { font-size: var(--base-font-size); }

body {
  font-family: "Helvetica Neue", Arial, sans-serif;
  background: var(--bg-gradient), url("images/costellazione/cosmo-bg.jpg") center / cover fixed;
  color: var(--text-color);
  line-height: 1.6;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  min-height:100vh;
  position:relative;
  padding: 1rem;
}

/* TITOLI */
h1, h2 {
  font-family: 'LemonMilkLight', "Helvetica Neue", Arial, sans-serif;
}

/* Rimosso text-transform: lowercase per permettere al parsing di gestire le maiuscole correttamente */
.content p, .content li, header p.subtitle, footer {
  /* text-transform: lowercase; <- rimosso per non interferire con i nomi propri dei pianeti */
}

#starfield {
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  mix-blend-mode: screen;
}

.page {
  position: relative;
  z-index: 2;
  max-width: 980px;
  margin: 1.5rem auto;
}

h1, h2, p, a, li {
  font-size: 1rem;
  font-weight: 400;
  letter-spacing: normal;
  line-height: 1.7;
  color: var(--text-color);
}

header {
  text-align: center;
  margin-bottom: 1.5rem;
}

header h1 {
  font-size: 1.8rem;
  font-weight: 600;
  margin-bottom: 0.3rem;
}

header p.subtitle {
  margin-top: 0.4rem;
  color: var(--text-color);
  opacity: 0.9;
  max-width: 880px;
  margin-left: auto;
  margin-right: auto;
  font-style: italic;
}

img.main-image {
  display:block;
  width:100%;
  height:auto;
  margin: 1.2rem 0;
  border-radius: 12px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.65);
  transition: transform 0.3s ease;
}
img.main-image:hover {
  transform: scale(1.02);
}

.content {
  background: var(--content-bg);
  backdrop-filter: blur(10px);
  padding: 2.5rem; /* Aumentato padding per leggibilità */
  border-radius: 16px;
  box-shadow: 0 10px 35px rgba(0,0,0,0.6);
}

/* Stile per i titoli generati dinamicamente */
.content h2 {
  margin-top: 2.2rem;
  margin-bottom: 1rem;
  color: var(--accent);
  font-size: 1.2rem;
  font-weight: 600;
  border-bottom: 1px solid rgba(255,255,255,0.2);
  padding-bottom: 0.4rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.content p { margin-bottom: 1.2rem; }
.content ul { padding-left: 1.5rem; margin-bottom: 1.5rem; list-style-type: square; }
.content li { margin-bottom: 0.8rem; }

a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

.discover {
  margin-top: 1.5rem;
  text-align: center;
}
.discover a {
  display: inline-block;
  padding: 0.65rem 1.2rem;
  border-radius: 12px;
  background: linear-gradient(135deg, rgba(229,57,53,0.15), rgba(201,214,223,0.05));
  border: 1px solid rgba(255,255,255,0.1);
  color: var(--highlight);
  font-weight: 700;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  box-shadow: 0 8px 22px rgba(0,0,0,0.45);
  transition: all 0.25s ease;
}
.discover a:hover {
  transform: translateY(-4px);
  background: linear-gradient(135deg, rgba(229,57,53,0.25), rgba(201,214,223,0.1));
  box-shadow: 0 16px 36px rgba(0,0,0,0.55);
}

footer { text-align:center; margin-top:1.5rem; color: rgba(255,255,255,0.75); font-size:0.9rem; padding-bottom: 2rem; }

@media (prefers-reduced-motion: reduce) {
  #starfield { display: none !important; }
}
</style>
</head>
<body>

<canvas id="starfield" aria-hidden="true"></canvas>

<div class="page">
  <header>
    <h1>Il cielo di <span id="current-month">...</span> 2026</h1>
    <p class="subtitle">Scopri le stelle, la Luna e i pianeti più visibili nel cielo di questo mese</p>
  </header>

  <img src="https://astrinascentiastronomia-maker.github.io/astri-nascenti/astri-nascenti/cielo-mese/images/costellazione2.jpg" alt="Cielo del mese" class="main-image">

  <main class="content" id="main-content" role="main">
    <p style="text-align:center; opacity:0.6;">Sintonizzando i telescopi...</p>
  </main>

  <div class="discover">
    <a href="https://astrinascentiastronomia-maker.github.io/astri-nascenti/astri-nascenti/cielo-mese/scopri-costellazione/scopri.html" target="_blank" rel="noopener noreferrer">
      Scopri la costellazione del mese
    </a>
  </div>

  <footer>© Astri Nascenti</footer>
</div>

<script>
(function(){
  const months = ["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
  const now = new Date();
  const el = document.getElementById("current-month");
  if (el) el.textContent = months[now.getMonth()];
})();
</script>

<script>
(function(){
  const url = "https://astrinascentiastronomia-maker.github.io/astri-nascenti/astri-nascenti/cielo-mese/cielo.txt";
  const container = document.getElementById('main-content');
  if(!container) return;

  fetch(url)
    .then(res => {
      if(!res.ok) throw new Error();
      return res.text();
    })
    .then(rawText => {
      // Pulizia testo (rimozione spazi bianchi eccessivi)
      let text = rawText.trim();

      // 1. Identifichiamo i titoli delle categorie e trasformiamoli in <h2>
      const categories = [
        "La Luna",
        "I pianeti: chi brilla e chi si nasconde",
        "Cielo profondo: nebulose, ammassi e galassie",
        "Consigli rapidi per osservare"
      ];

      // Sostituzione categorie con tag H2
      categories.forEach(cat => {
        const regex = new RegExp(cat, 'gi');
        text = text.replace(regex, `</p><h2>${cat}</h2><p>`);
      });

      // 2. Gestione lista puntata per i "Consigli rapidi"
      // Cerchiamo le righe che iniziano con un numero (1., 2., 3.)
      text = text.replace(/(\d\.\s)(.*?)(\.|\?|!)(?=\s|$)/g, '<li>$2$3</li>');
      
      // Se abbiamo creato dei <li>, dobbiamo avvolgerli in un <ul>
      if (text.includes('<li>')) {
        // Cerchiamo dove iniziano i LI dopo il titolo dei consigli e chiudiamo la lista alla fine
        text = text.replace(/<h2>Consigli rapidi per osservare<\/h2><p>/i, '<h2>Consigli rapidi per osservare</h2><ul>');
        text = text.replace(/<\/li><p>/g, '</li>'); // pulizia paragrafi vuoti
        // Chiudiamo l'ultimo UL se necessario
        text += '</ul>';
      }

      // 3. Avvolgiamo il tutto in un paragrafo iniziale e puliamo tag vuoti
      let finalHtml = '<p>' + text + '</p>';
      
      // Pulizia: rimuove paragrafi vuoti <p></p> creati dalle sostituzioni
      finalHtml = finalHtml.replace(/<p>\s*<\/p>/g, '');
      finalHtml = finalHtml.replace(/<p><ul>/g, '<ul>').replace(/<\/ul><\/p>/g, '</ul>');

      container.innerHTML = finalHtml;
    })
    .catch(err => {
      container.innerHTML = "<p>Impossibile caricare il testo del mese. Controlla la connessione.</p>";
    });
})();
</script>

<script>
(function(){
  if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
  const canvas = document.getElementById('starfield');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const DPR = Math.max(1, window.devicePixelRatio || 1);
  let w = 0, h = 0, stars = [];

  function rand(a,b){ return Math.random()*(b-a)+a; }
  function resizeCanvas(){
    w = window.innerWidth; h = window.innerHeight;
    canvas.width = Math.round(w * DPR); canvas.height = Math.round(h * DPR);
    canvas.style.width = w + 'px'; canvas.style.height = h + 'px';
    ctx.setTransform(1,0,0,1,0,0); ctx.scale(DPR, DPR);
  }

  function initStars(){
    resizeCanvas();
    const NUM = Math.min(1200, Math.round((w * h) / 90000) * 30);
    stars = [];
    for(let i=0;i<NUM;i++){
      stars.push({
        x: rand(0,w), y: rand(0,h),
        r: Math.random()<0.03 ? rand(1.2,2.6) : rand(0.3,1.0),
        alpha: rand(0.15,0.95), tw: rand(0,Math.PI*2)
      });
    }
  }

  function draw(now){
    ctx.clearRect(0,0,w,h);
    stars.forEach(s=>{
      const pulse = 0.6 + 0.4*Math.sin(now*0.002 + s.tw);
      const a = Math.max(0.08, s.alpha * pulse);
      const grad = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r*6);
      grad.addColorStop(0, 'rgba(255,255,255,' + (0.9*a) + ')');
      grad.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = grad;
      ctx.fillRect(s.x - s.r*6, s.y - s.r*6, s.r*12, s.r*12);
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
      ctx.fillStyle = 'rgba(255,255,255,' + (0.9*a) + ')';
      ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  window.addEventListener('resize', initStars);
  initStars();
  requestAnimationFrame(draw);
})();
</script>

</body>
</html>
