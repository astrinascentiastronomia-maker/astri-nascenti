<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Il cielo del mese - Dettaglio</title>

<style>
@font-face {
  font-family: 'LemonMilkLight';
  src: url('fonts/LemonMilk-Light.woff2') format('woff2'),
       url('fonts/LemonMilk-Light.woff') format('woff');
  font-display: swap;
}

/* VARIABILI */
:root{
  --bg-gradient: linear-gradient(rgba(0,0,0,.85), rgba(0,0,0,.95));
  --content-bg: rgba(0,0,0,0.55);
  --accent: #c9d6df;
  --base-font-size: 18px;
  --text-color: #ffffff;
}

/* RESET + BASE */
* { box-sizing: border-box; margin:0; padding:0; }
html { font-size: var(--base-font-size); }

body {
  font-family: "Helvetica Neue", Arial, sans-serif;
  background: var(--bg-gradient), url("images/costellazione/cosmo-bg.jpg") center / cover fixed;
  color: var(--text-color);
  line-height: 1.6;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  min-height:100vh;
  position:relative;
  padding: 1rem;
}

/* TITOLI */
h1, h2 {
  font-family: 'LemonMilkLight', "Helvetica Neue", Arial, sans-serif;
}

/* Visualizzazione testo: mantiene lo stile lowercase ma rispetta i tag <strong> */
.content p,
.content li,
header p.subtitle,
footer {
  text-transform: lowercase;
}
.content p::first-letter,
.content li::first-letter,
header p.subtitle::first-letter,
footer::first-letter {
  text-transform: uppercase;
}

/* Se una parola è <strong>, vogliamo che sia ben visibile anche se in minuscolo */
.content strong {
  font-weight: 700;
  color: #fff;
}

/* canvas stelle */
#starfield {
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  mix-blend-mode: screen;
}

/* contenuto principale */
.page {
  position: relative;
  z-index: 2;
  max-width: 980px;
  margin: 1.5rem auto;
}

h1, h2, p, a, li {
  font-size: 1rem;
  font-weight: 400;
  letter-spacing: normal;
  line-height: 1.7;
  color: var(--text-color);
}

header {
  text-align: center;
  margin-bottom: 1.5rem;
}

header h1 {
  font-size: 1.8rem;
  font-weight: 600;
  margin-bottom: 0.3rem;
  text-transform: uppercase;
}

header p.subtitle {
  margin-top: 0.4rem;
  color: var(--text-color);
  opacity: 0.9;
  max-width: 880px;
  margin-left: auto;
  margin-right: auto;
  font-style: italic;
}

/* immagine principale */
img.main-image {
  display:block;
  width:100%;
  height:auto;
  margin: 1.2rem 0;
  border-radius: 12px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.65);
  transition: transform 0.3s ease;
}
img.main-image:hover {
  transform: scale(1.02);
}

/* box contenuto */
.content {
  background: var(--content-bg);
  backdrop-filter: blur(10px);
  padding: 2rem;
  border-radius: 16px;
  box-shadow: 0 10px 35px rgba(0,0,0,0.6);
}

.content p {
    margin-bottom: 1.2rem;
}

.back-home {
  margin-top: 2rem;
  text-align: center;
}
.back-home a {
  display: inline-block;
  padding: 0.65rem 1rem;
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--accent);
  font-weight: 700;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  box-shadow: 0 8px 22px rgba(0,0,0,0.45);
  transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
}
.back-home a:hover {
  transform: translateY(-4px);
  background: rgba(255, 255, 255, 0.1);
  box-shadow: 0 16px 36px rgba(0,0,0,0.55);
}

footer { text-align:center; margin-top:2rem; color: rgba(255,255,255,0.75); font-size:0.9rem; padding-bottom: 2rem;}

@media (prefers-reduced-motion: reduce) {
  #starfield { display: none !important; }
}
</style>
</head>
<body>

<canvas id="starfield" aria-hidden="true"></canvas>

<div class="page">
  <header>
    <h1>Il cielo di <span id="current-month">...</span> 2026</h1>
    <p class="subtitle">Scopri le stelle, la Luna e i pianeti più visibili nel cielo di questo mese</p>
  </header>

  <img src="https://astrinascentiastronomia-maker.github.io/astri-nascenti/astri-nascenti/cielo-mese/images/costellazione1.jpg" alt="Costellazione" class="main-image">

  <main class="content" id="costellazione-content" role="main">
    <p>Caricamento dei dati celesti...</p>
  </main>

  <div class="back-home">
    <a href="https://astrinascentiastronomia-maker.github.io/astri-nascenti/">
      Torna alla home
    </a>
  </div>

  <footer>© Astri Nascenti</footer>
</div>

<script>
/* 1. SCRIPT CARICAMENTO E FORMATTAZIONE TESTO TXT */
(function(){
  const url = "https://astrinascentiastronomia-maker.github.io/astri-nascenti/astri-nascenti/cielo-mese/scopri-costellazione/costellazione.txt";
  const container = document.getElementById('costellazione-content');

  fetch(url)
    .then(response => {
      if (!response.ok) throw new Error("File non trovato");
      return response.text();
    })
    .then(text => {
      // REGEX LOGIC:
      // \b[A-ZÀ-Ž]{2,}\b
      // \b = confini della parola
      // [A-ZÀ-Ž] = Lettere maiuscole (incluse accentate italiane)
      // {2,} = minimo 2 caratteri (esclude parole di una sola lettera come "A", "E", "O", "I")
      let formattedText = text.replace(/\b[A-ZÀ-Ž]{2,}\b/g, function(match) {
        return '<strong>' + match + '</strong>';
      });

      // Divide il testo in paragrafi basandosi sugli invii a capo
      const paragraphs = formattedText.split(/\r?\n/).filter(p => p.trim() !== "");
      
      // Sostituisce il contenuto del main
      container.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join("");
    })
    .catch(err => {
      console.error(err);
      container.innerHTML = "<p>Si è verificato un errore nel caricamento del testo.</p>";
    });
})();

/* 2. SCRIPT MESE CORRENTE */
(function(){
  const months = ["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
  const now = new Date();
  const el = document.getElementById("current-month");
  if (el) el.textContent = months[now.getMonth()];
})();

/* 3. ANIMAZIONE STELLE */
(function(){
  if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
  const canvas = document.getElementById('starfield');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const DPR = Math.max(1, window.devicePixelRatio || 1);
  let w = 0, h = 0, stars = [];

  function rand(a,b){ return Math.random()*(b-a)+a; }
  function resizeCanvas(){
    w = window.innerWidth; h = window.innerHeight;
    canvas.width = Math.round(w * DPR); canvas.height = Math.round(h * DPR);
    canvas.style.width = w + 'px'; canvas.style.height = h + 'px';
    ctx.setTransform(1,0,0,1,0,0); ctx.scale(DPR, DPR);
  }

  function initStars(){
    resizeCanvas();
    const NUM = Math.min(1200, Math.round((w * h) / 90000) * 30);
    stars = [];
    for(let i=0;i<NUM;i++){
      stars.push({
        x: rand(0,w), y: rand(0,h),
        r: Math.random()<0.03 ? rand(1.2,2.6) : rand(0.3,1.0),
        alpha: rand(0.15,0.95), tw: rand(0,Math.PI*2)
      });
    }
  }

  function draw(now){
    ctx.clearRect(0,0,w,h);
    stars.forEach(s=>{
      const pulse = 0.6 + 0.4*Math.sin(now*0.002 + s.tw);
      const a = Math.max(0.08, s.alpha * pulse);
      const grad = ctx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r*6);
      grad.addColorStop(0, 'rgba(255,255,255,' + (0.9*a) + ')');
      grad.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = grad;
      ctx.fillRect(s.x - s.r*6, s.y - s.r*6, s.r*12, s.r*12);
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
      ctx.fillStyle = 'rgba(255,255,255,' + (0.9*a) + ')';
      ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  window.addEventListener('resize', initStars);
  initStars();
  requestAnimationFrame(draw);
})();
</script>

</body>
</html>
